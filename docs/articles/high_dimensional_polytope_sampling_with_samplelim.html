<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>High dimensional polytope sampling with samplelim • samplelim</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="High dimensional polytope sampling with samplelim">
<meta property="og:description" content="samplelim">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">samplelim</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/high_dimensional_polytope_sampling_with_samplelim.html">High dimensional polytope sampling with samplelim</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/pregnault/samplelim/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>High dimensional polytope sampling with
samplelim</h1>
                        <h4 data-toc-skip class="author">Jacques
Bréhélin, Philippe Regnault</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/pregnault/samplelim/blob/HEAD/vignettes/high_dimensional_polytope_sampling_with_samplelim.rmd" class="external-link"><code>vignettes/high_dimensional_polytope_sampling_with_samplelim.rmd</code></a></small>
      <div class="hidden name"><code>high_dimensional_polytope_sampling_with_samplelim.rmd</code></div>

    </div>

    
    
<p>The package <a href="https://github.com/pregnault/samplelim.git" class="external-link">samplelim</a> for the R statistical software
provides an efficient implementations (C++ encoded) of Markov Chain
Monte Carlo (MCMC) algorithms for uniformly sampling high-dimensional
polytopes. It aims particularly at handling linear inverse models (LIM)
in metabolic (trophic, biochemical or urban) networks. Some support
functions are also included that facilitate its use by
practitioners.</p>
<div class="section level2">
<h2 id="objective">Objective<a class="anchor" aria-label="anchor" href="#objective"></a>
</h2>
<p><a href="https://github.com/pregnault/samplelim.git" class="external-link">samplelim</a> implements two MCMC algorithms for sampling
high-dimensional polytopes, the Mirror Walk (MiW) introduced by Van
Oevelen <em>et al.</em> (2010) and the Billiard Walk (BiW) introduced by
Polyak and Gryazina (2014). Thanks to the inclusion of easy to use
support functions for linear inverse modeling of metabolic networks,
<a href="https://github.com/pregnault/samplelim.git" class="external-link">samplelim</a> updated, extended, low-level-encoded, version
of the R package <a href="https://cran.r-project.org/web/packages/limSolve/index.html" class="external-link"><code>{limsolve}</code></a>,
that includes easy to use support functions for linear inverse modeling
of metabolic networks.</p>
<p><a href="https://github.com/pregnault/samplelim.git" class="external-link">samplelim</a> is built upon the C++ library <a href="https://github.com/GeomScale/volesti" class="external-link"><code>{volesti}</code></a>.
Precisely, the source code of the R package <code>{volesti}</code>
1.1.2-6 has been forked from its <a href="https://github.com/GeomScale/volesti/releases/tag/v1.1.2-6" class="external-link">GitHub
repository</a> as a basis for developing <a href="https://github.com/pregnault/samplelim.git" class="external-link">samplelim</a>.</p>
<p>The C++ library <code>{volesti}</code> provides efficient
implementations of different MCMC algorithms for sampling
high-dimensional polytopes and estimating their volumes. The R package
counterpart proposes a subset of these algorithms among which the
BiW.</p>
<p><a href="https://github.com/pregnault/samplelim.git" class="external-link">samplelim</a> aims at combining the performance of
<code>{volesti}</code> with the convenient for practitioners features of
<code>{limsolve}</code> :</p>
<ul>
<li>the MiW is implemented in an optimized C++ encoded version of the
version encoded in pure R programming language in
<code>{limsolve}</code>;</li>
<li>
<a href="https://github.com/pregnault/samplelim.git" class="external-link">samplelim</a> includes and slightly modifies the BiW from
<code>{volesti}</code> 1.1.2-6 – the uniform distribution of the path
length being replaced by the exponential distribution, as originally
suggested by Polyak and Gryazina (2014);</li>
<li>support functions allowing an easy handling by users are included.
These functions are updated/modified versions of the original ones
present in <code>{limsolve}</code>.</li>
</ul>
</div>
<div class="section level2">
<h2 id="definitions">Definitions<a class="anchor" aria-label="anchor" href="#definitions"></a>
</h2>
<div class="section level3">
<h3 id="reflective-algorithms">Reflective algorithms<a class="anchor" aria-label="anchor" href="#reflective-algorithms"></a>
</h3>
<p><a href="https://github.com/pregnault/samplelim.git" class="external-link">samplelim</a> implements two sampling algorithms called
Mirror Walk (MiW) an Billiard Walk (BiW), that rely on a reflection
mechanism on the borders of the polytope to be sampled. Their general
principle consists in drawing randomly the direction and path length of
a segement as in the classical hit-and-run algorithm. However, if the
trajectory reaches a border of the polytope before the random path
length is achieved, then it is reflected on this border, moving forward
this reflected direction for the remaining distance. This is repeated
until the trajectory finally reaches a point within the polytope. Then,
new direction and path length are randomly chosen, and so on.</p>
<div class="figure" style="text-align: center">
<img src="figures/reflection.png" alt="Reflection of the path in the MiW and BiW algorithms" width="50%"><p class="caption">
Reflection of the path in the MiW and BiW algorithms
</p>
</div>
</div>
<div class="section level3">
<h3 id="jump-length">Jump length<a class="anchor" aria-label="anchor" href="#jump-length"></a>
</h3>
<p>Both the MiW and the BiW algorithms use a parameter called “jump
length” (<code>jmp</code>) in drawing the direction and length of the
segment.</p>
<p>This is an important parameter: if its value is too small,
exploration of the polytope will not be efficient and would require a
very large number of points . Conversely, if the jump is too big the
sampling process could take time because the trajectory of the chain may
reach borders of the polytope and hence many reflections will need to be
computed.</p>
<p>The precise definition of the jump differs between the two
algorithms:</p>
<ul>
<li><p>For the MiW, direction and length are obtained as the direction
and norm of a vector <span class="math inline">\(v\)</span>, where <span class="math inline">\(v\)</span> is s drawn from a centered non
correlated Gaussian vector <span class="math inline">\(V =
(V_1,...,V_n)\)</span> with Var <span class="math inline">\(V_i =
\sigma_i^2\)</span>. The vector <span class="math inline">\(\sigma^2=(\sigma_1^2,...,\sigma_n^2)\)</span> is
called the <strong>jump length</strong>.</p></li>
<li><p>For the BiW, the direction is drawn from the uniform distribution
on the unit sphere of <span class="math inline">\(\mathbb{R}^n\)</span>
and the path length is <span class="math inline">\(L=\tau
\log(1/U)\)</span> where <span class="math inline">\(U\)</span> is drawn
from a uniform distribution on <span class="math inline">\([0,
1]\)</span>. The <strong>jump length</strong> is the parameter <span class="math inline">\(\tau &gt; 0\)</span>.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="thinning-and-burn-in">Thinning and burn-in<a class="anchor" aria-label="anchor" href="#thinning-and-burn-in"></a>
</h3>
<p>To achieve an MCMC sample closer to a sample of a uniform
distribution, two integer parameters are to be used: the burn-in
(<code>burn</code>) and the thinning (<code>thin</code>).</p>
<p>Let a sample be obtained as described above. Then,</p>
<ul>
<li><p>The first values of the sample are correlated with the starting
point and far from the limit uniform distribution of the chain. Thus,
the burn-in parameter is the number of first values to be discarded from
the sample.</p></li>
<li><p>Consecutive points of a Markov chain are highly correlated. Thus,
the thinning parameter is the number of points to be discarded between
points kept in the final sample.</p></li>
</ul>
<p>For more information about choosing the burn-in and thinning values,
see Section <a href="#raftery_lewis">The Raftery and Lewis
diagnostic</a>.</p>
</div>
</div>
<div class="section level2">
<h2 id="the-polytope-to-be-sampled">The polytope to be sampled<a class="anchor" aria-label="anchor" href="#the-polytope-to-be-sampled"></a>
</h2>
<p>An intersection of hyper-planes and half-spaces defines an <span class="math inline">\(n\)</span>-dimensional convex set known as a
polytope <span class="math inline">\(\mathcal{P}\)</span>. In
mathematical words, <span class="math inline">\(\mathcal{P} = \{ x \in
\mathbb{R}^n: Ax = B, Gx \geq H \}\)</span>, where <span class="math inline">\(A\)</span> is an <span class="math inline">\(m\times n\)</span> matrix, with <span class="math inline">\(m \leq n\)</span>, <span class="math inline">\(B
\in \mathbb{R}^m\)</span>, <span class="math inline">\(G\)</span> is a
<span class="math inline">\(k \times n\)</span> matrix, with <span class="math inline">\(k \geq 0\)</span> and <span class="math inline">\(H \in \mathbb{R}^k\)</span>. Inequality
constraints, represented by the matrix <span class="math inline">\(G\)</span>, always present in linear inverse
models for metabolic networks, make the polytope bounded.</p>
<p>For the mere aim of illustration, we will consider in the following
the minimal toy example defined by the constraints</p>
<p><span class="math display">\[\begin{cases}
  1x_1 + 1x_2 + 1x_3 = 1 \\
  0x_1 + 0x_2 + 1x_3 \geq 0.7 \\
  0x_1 + 0x_2 - 1x_3 \geq 0 \\
  0x_1 + 1x_2 + 0x_3 \geq 0.8 \\
  0x_1 - 1x_2 + 0x_3 \geq 0 \\
  1x_1 + 0x_2 + 0x_3 \geq 0.8 \\
  -1x_1 + 0x_2 + 0x_3 \geq 0 \\
\end{cases}\]</span></p>
<p>with associated matrices <span class="math display">\[
\mathbf{A} = \begin{pmatrix}
1 &amp; 1 &amp; 1
\end{pmatrix}, \quad
\mathbf{B} = \begin{pmatrix}
1
\end{pmatrix}, \quad
\mathbf{G} = \begin{pmatrix}
  0 &amp; 0 &amp; 1 \\
  0 &amp; 0 &amp; -1 \\
  0 &amp; 1 &amp; 0 \\
  0 &amp; -1 &amp; 0 \\
  1 &amp; 0 &amp; 0 \\
  -1 &amp; 0 &amp;0
\end{pmatrix},\quad
\mathbf{H} = \begin{pmatrix}
0.7 \\
0 \\
0.8 \\
0 \\
0.8 \\
0
\end{pmatrix}\]</span>.</p>
<p>The main argument <code>lim</code> of <code><a href="../reference/rlim.html">rlim()</a></code> is a list
with (at least) four components named <code>A</code>, <code>B</code>,
<code>G</code> and <code>H</code>, that are the matrices and vectors
defining the polytope to be sampled. Below those components are set with
the values of the toy model.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/pregnault/samplelim.git" class="external-link">"samplelim"</a></span><span class="op">)</span></span>
<span><span class="co"># Define equality and inequality constraints through matrices A, B, G, H</span></span>
<span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">1</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">G</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>,</span>
<span>              <span class="fl">0</span>, <span class="fl">0</span>, <span class="op">-</span><span class="fl">1</span>,</span>
<span>              <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, </span>
<span>              <span class="fl">0</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>,</span>
<span>              <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, </span>
<span>              <span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>            byrow <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            nrow <span class="op">=</span> <span class="fl">6</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">H</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">0</span>, <span class="fl">0.8</span>, <span class="fl">0</span>, <span class="fl">0.8</span>, <span class="fl">0</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span><span class="co"># Store into a list</span></span>
<span><span class="va">lim_exm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>A <span class="op">=</span> <span class="va">A</span>, B <span class="op">=</span> <span class="va">B</span>,G <span class="op">=</span> <span class="va">G</span>,H <span class="op">=</span> <span class="va">H</span><span class="op">)</span></span>
<span><span class="co"># Sampling into the polytope defined by these constraints</span></span>
<span><span class="va">sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rlim.html">rlim</a></span><span class="op">(</span><span class="va">lim_exm</span><span class="op">)</span></span>
<span><span class="co"># Show first points of the sample with the head function</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sample</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           [,1]      [,2]      [,3]</span></span>
<span><span class="co">## [1,] 0.2002727 0.1354266 0.6643007</span></span>
<span><span class="co">## [2,] 0.1601968 0.2044786 0.6353246</span></span>
<span><span class="co">## [3,] 0.2434451 0.2680386 0.4885162</span></span>
<span><span class="co">## [4,] 0.2464662 0.1946565 0.5588773</span></span>
<span><span class="co">## [5,] 0.3173816 0.1214052 0.5612132</span></span>
<span><span class="co">## [6,] 0.3147804 0.0250392 0.6601804</span></span></code></pre>
<p>The sample generated by <code><a href="../reference/rlim.html">rlim()</a></code> can be visualized thanks
to a 3D scatterplot.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Preparing sample for 3D scatterplot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">sample</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="st">"Y"</span>,<span class="st">"Z"</span><span class="op">)</span></span>
<span><span class="va">sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">sample</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://plotly-r.com" class="external-link">"plotly"</a></span><span class="op">)</span></span>
<span><span class="va">plot_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/plot_ly.html" class="external-link">plot_ly</a></span><span class="op">(</span><span class="va">sample</span>, x <span class="op">=</span> <span class="op">~</span><span class="va">X</span>, y <span class="op">=</span> <span class="op">~</span><span class="va">Y</span>, z <span class="op">=</span> <span class="op">~</span><span class="va">Z</span>, size <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">plot_sample</span> <span class="op">&lt;-</span> <span class="va">plot_sample</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/add_trace.html" class="external-link">add_markers</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">plot_sample</span> <span class="op">&lt;-</span> <span class="va">plot_sample</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">layout</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Estimation of the polytope </span></span>
<span><span class="st">              using sample points"</span><span class="op">)</span></span>
<span><span class="va">plot_sample</span></span></code></pre></div>
<p><img src="figures/polytope.png"></p>
</div>
<div class="section level2">
<h2 id="sampling-the-polytope-for-a-model-defined-in-a-file">Sampling the polytope for a model defined in a file<a class="anchor" aria-label="anchor" href="#sampling-the-polytope-for-a-model-defined-in-a-file"></a>
</h2>
<p>First the model saved in DeclarationFileBOWF-short.txt file is
imported and converted into a <code>lim</code> object using
<code><a href="../reference/df2lim.html">df2lim()</a></code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">DF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"DeclarationFileBOWF-short.txt"</span>, package <span class="op">=</span> <span class="st">"samplelim"</span><span class="op">)</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/df2lim.html">df2lim</a></span><span class="op">(</span><span class="va">DF</span><span class="op">)</span></span></code></pre></div>
<p>All the attributes of the model are listed as follows.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">att</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="va">att</span></span></code></pre></div>
<pre><code><span><span class="co">## $names</span></span>
<span><span class="co">##  [1] "file"         "NUnknowns"    "NEquations"   "NConstraints" "NComponents" </span></span>
<span><span class="co">##  [6] "NExternal"    "NVariables"   "A"            "B"            "G"           </span></span>
<span><span class="co">## [11] "H"            "Cost"         "Profit"       "Flowmatrix"   "VarA"        </span></span>
<span><span class="co">## [16] "VarB"         "Parameters"   "Components"   "Externals"    "rates"       </span></span>
<span><span class="co">## [21] "markers"      "Variables"    "costnames"    "profitnames"  "eqnames"     </span></span>
<span><span class="co">## [26] "ineqnames"    "Unknowns"     "ispos"       </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $class</span></span>
<span><span class="co">## [1] "lim"</span></span></code></pre>
<p>These attributes can be accessed by using ‘$attribute’, for example
variable names.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span><span class="op">$</span><span class="va">Variables</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "FBFIngest"   "BIVIngest"   "ZOOIngest"   "BACIngest"   "FBFprod"    </span></span>
<span><span class="co">##  [6] "BACprod"     "ZOOprod"     "BIVprod"     "PHYprod"     "GPP"        </span></span>
<span><span class="co">## [11] "totRES"      "Herbivory"   "DETritivory"</span></span></code></pre>
<p>Theoretical ranges for all variables can be determined using the
<code><a href="../reference/pol.ranges.html">lim.ranges()</a></code> function. It provides a lower bound, an upper
bound, and the range (length of the interval between bounds).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pol.ranges.html">lim.ranges</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                  min        max      range</span></span>
<span><span class="co">## FIX-&gt;PHY 114.4444444 860.000000 745.555556</span></span>
<span><span class="co">## IMP-&gt;FBF   0.8294294  19.140679  18.311249</span></span>
<span><span class="co">## DET-&gt;BIV   9.7687500  91.874002  82.105252</span></span>
<span><span class="co">## DET-&gt;ZOO   0.0000000  27.892545  27.892545</span></span>
<span><span class="co">## DET-&gt;BAC   0.0000000 848.497039 848.497039</span></span>
<span><span class="co">## PHY-&gt;RES   5.7222222 258.000000 252.277778</span></span>
<span><span class="co">## PHY-&gt;DET   5.7222222 430.000000 424.277778</span></span>
<span><span class="co">## PHY-&gt;BIV  35.8187500 170.623147 134.804397</span></span>
<span><span class="co">## PHY-&gt;ZOO   1.3768528 136.181250 134.804397</span></span>
<span><span class="co">## PHY-&gt;BAC   0.0000000 128.291897 128.291897</span></span>
<span><span class="co">## PHY-&gt;LOS   0.0000000 128.291897 128.291897</span></span>
<span><span class="co">## BAC-&gt;RES   0.0000000 506.793943 506.793943</span></span>
<span><span class="co">## BAC-&gt;DET   0.0000000 308.624517 308.624517</span></span>
<span><span class="co">## BAC-&gt;LOS   0.0000000 529.070600 529.070600</span></span>
<span><span class="co">## ZOO-&gt;RES   0.1658859  49.222139  49.056253</span></span>
<span><span class="co">## ZOO-&gt;DET   0.3317718  82.036898  81.705126</span></span>
<span><span class="co">## ZOO-&gt;FBF   0.8294294  19.140679  18.311249</span></span>
<span><span class="co">## ZOO-&gt;BIV   0.0000000  38.690056  38.690056</span></span>
<span><span class="co">## ZOO-&gt;ZOO   0.0000000  16.407380  16.407380</span></span>
<span><span class="co">## ZOO-&gt;LOS   0.0000000  77.284275  77.284275</span></span>
<span><span class="co">## BIV-&gt;RES  18.2350000 195.710163 177.475163</span></span>
<span><span class="co">## BIV-&gt;DET  11.7225000 110.248803  98.526303</span></span>
<span><span class="co">## BIV-&gt;FBF   0.8294294  19.140679  18.311249</span></span>
<span><span class="co">## BIV-&gt;LOS   0.3968214  77.088716  76.691894</span></span>
<span><span class="co">## FBF-&gt;RES   3.1901131  31.901131  28.711018</span></span>
<span><span class="co">## FBF-&gt;DET   0.6380226  31.901131  31.263108</span></span>
<span><span class="co">## FBF-&gt;FBF   0.6380226   6.380226   5.742204</span></span>
<span><span class="co">## FBF-&gt;LOS   0.0000000   4.017179   4.017179</span></span></code></pre>
<p>The sampling of the polytope is obtained by using the
<code><a href="../reference/rlim.html">rlim()</a></code> function.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rlim.html">rlim</a></span><span class="op">(</span><span class="va">model</span>, nsamp<span class="op">=</span><span class="fl">5000</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sample</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      FIX-&gt;PHY IMP-&gt;FBF DET-&gt;BIV   DET-&gt;ZOO DET-&gt;BAC  PHY-&gt;RES PHY-&gt;DET PHY-&gt;BIV</span></span>
<span><span class="co">## [1,] 304.7398 8.188190 41.13866  2.7547661 191.7810  22.82508 116.5854 72.50837</span></span>
<span><span class="co">## [2,] 310.0166 7.289395 20.44853 11.2781200 208.4425  24.45221 121.4505 52.54402</span></span>
<span><span class="co">## [3,] 335.1810 4.073940 24.81560  6.2406614 184.5813  24.86050 139.8148 65.42448</span></span>
<span><span class="co">## [4,] 381.6556 6.260583 23.77029  5.3914830 280.6353  31.59105 187.6128 62.32985</span></span>
<span><span class="co">## [5,] 437.7902 6.586501 22.59578  2.3529756 270.7535 102.43286 184.4280 66.43580</span></span>
<span><span class="co">## [6,] 473.2961 6.587768 21.11376  0.5112398 290.2647 123.50966 194.6432 75.63598</span></span>
<span><span class="co">##      PHY-&gt;ZOO    PHY-&gt;BAC  PHY-&gt;LOS  BAC-&gt;RES BAC-&gt;DET  BAC-&gt;LOS ZOO-&gt;RES</span></span>
<span><span class="co">## [1,] 59.80315  5.23948692 27.778340 115.37803 32.25215  49.39029 16.36737</span></span>
<span><span class="co">## [2,] 76.64730 13.18244357 21.740057  89.80800 65.83728  65.97968 24.52340</span></span>
<span><span class="co">## [3,] 53.65594 27.92060867 23.504666  77.19170 21.71152 113.59871 17.47108</span></span>
<span><span class="co">## [4,] 61.91220  5.04864128 33.161092  79.23301 51.96859 154.48238 10.06050</span></span>
<span><span class="co">## [5,] 73.94561  4.69108540  5.856817  78.89247 42.99369 153.55840 17.91442</span></span>
<span><span class="co">## [6,] 67.19485  0.09761946 12.214762 126.34517 33.68154 130.33562 13.38351</span></span>
<span><span class="co">##      ZOO-&gt;DET ZOO-&gt;FBF  ZOO-&gt;BIV  ZOO-&gt;ZOO  ZOO-&gt;LOS BIV-&gt;RES BIV-&gt;DET BIV-&gt;FBF</span></span>
<span><span class="co">## [1,] 22.71853 7.604794 12.465501 4.2681856  3.401717 38.24217 52.54603 7.252428</span></span>
<span><span class="co">## [2,] 21.35765 7.374766 12.183025 3.8145890 22.486571 38.23405 22.53904 6.834049</span></span>
<span><span class="co">## [3,] 24.25100 3.775960  6.702346 2.5531203  7.696216 41.66280 27.28734 3.880078</span></span>
<span><span class="co">## [4,] 34.75122 7.448425  2.859171 3.2713745 12.184368 34.09816 29.80863 7.685167</span></span>
<span><span class="co">## [5,] 29.05678 6.501696 14.203753 6.6396701  8.621930 47.62291 30.38804 5.731392</span></span>
<span><span class="co">## [6,] 32.13029 5.352583 12.628739 0.7826344  4.210968 39.98247 41.72258 6.887012</span></span>
<span><span class="co">##      BIV-&gt;LOS  FBF-&gt;RES  FBF-&gt;DET FBF-&gt;FBF   FBF-&gt;LOS</span></span>
<span><span class="co">## [1,] 28.07190 10.918909 11.572327 4.488263 0.55417527</span></span>
<span><span class="co">## [2,] 17.56845 11.479992  8.984660 4.096887 1.03355846</span></span>
<span><span class="co">## [3,] 24.11221  8.577051  2.572923 2.040761 0.58000482</span></span>
<span><span class="co">## [4,] 17.36734 14.940587  5.655848 4.524135 0.79773901</span></span>
<span><span class="co">## [5,] 19.49299  8.770760  8.835711 3.665106 1.21311748</span></span>
<span><span class="co">## [6,] 20.78643  9.077730  9.712114 4.315374 0.03751877</span></span></code></pre>
<p>Note that the above sequence of draws <strong>must not</strong> be
studied as a representative sample of the polytope, since its parameters
(thinning, burning, sample size) were not chosen accurately.</p>
<p>A new sample has to be computed, using the correct parameters
obtained via the <a href="#raftery_lewis">Raftery and Lewis
diagnostics</a> from this initial sequence of draws.</p>
</div>
<div class="section level2">
<h2 id="evaluating-the-quality-of-a-sample-using-performance-diagnostics">Evaluating the quality of a sample using performance
diagnostics<a class="anchor" aria-label="anchor" href="#evaluating-the-quality-of-a-sample-using-performance-diagnostics"></a>
</h2>
<p>Multiple statistical tools and criterion, usually known as
“diagnostics”, exist to evaluate the convergence of MCMC algorithms.
They are to be applied to sequences of draws and performed separately
for each variable (each flow), inducing some insight on the uniformity
of the distribution of draws. Here are some diagnostics that are of use
in <a href="https://hal.science/hal-04455831/document" class="external-link">Girardin et
al.</a>, where references are given.</p>
<div class="section level3">
<h3 id="raftery_lewis">The Raftery and Lewis diagnostic<a class="anchor" aria-label="anchor" href="#raftery_lewis"></a>
</h3>
<p>The main principle behind the Raftery and Lewis diagnostic is that a
correct sample of the objective distribution, here the uniform
distribution, should give precise estimates of its quantiles. Usually
the 0.025 quantile is used.</p>
<p>This diagnostic provides multiple pieces of information, such as the
burning value (M), an estimate of the sample size to ensure precise
estimation of a prescribed quantile (N), a lower bound (Nmin), and a
dependence factor (I).</p>
<p>The dependance factor assesses the extent to which auto-correlation
inflates the required sample size; values larger than 5 indicate a
strong auto-correlation.</p>
<p>Raftery and Lewis diagnosticperforms as follows.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">q</span> <span class="op">&lt;-</span> <span class="fl">0.025</span></span>
<span><span class="va">RL</span> <span class="op">&lt;-</span> <span class="fu">coda</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/coda/man/raftery.diag.html" class="external-link">raftery.diag</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">sample</span>, q<span class="op">=</span><span class="va">q</span><span class="op">)</span></span>
<span><span class="va">RL</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Quantile (q) = 0.025</span></span>
<span><span class="co">## Accuracy (r) = +/- 0.005</span></span>
<span><span class="co">## Probability (s) = 0.95 </span></span>
<span><span class="co">##                                                 </span></span>
<span><span class="co">##           Burn-in  Total Lower bound  Dependence</span></span>
<span><span class="co">##           (M)      (N)   (Nmin)       factor (I)</span></span>
<span><span class="co">##  FIX-&gt;PHY 18       19902 3746         5.310     </span></span>
<span><span class="co">##  IMP-&gt;FBF 2        3680  3746         0.982     </span></span>
<span><span class="co">##  DET-&gt;BIV 2        3803  3746         1.020     </span></span>
<span><span class="co">##  DET-&gt;ZOO 2        3803  3746         1.020     </span></span>
<span><span class="co">##  DET-&gt;BAC 18       20799 3746         5.550     </span></span>
<span><span class="co">##  PHY-&gt;RES 12       14451 3746         3.860     </span></span>
<span><span class="co">##  PHY-&gt;DET 15       17676 3746         4.720     </span></span>
<span><span class="co">##  PHY-&gt;BIV 2        3680  3746         0.982     </span></span>
<span><span class="co">##  PHY-&gt;ZOO 2        3930  3746         1.050     </span></span>
<span><span class="co">##  PHY-&gt;BAC 2        3741  3746         0.999     </span></span>
<span><span class="co">##  PHY-&gt;LOS 2        3803  3746         1.020     </span></span>
<span><span class="co">##  BAC-&gt;RES 8        10712 3746         2.860     </span></span>
<span><span class="co">##  BAC-&gt;DET 4        5211  3746         1.390     </span></span>
<span><span class="co">##  BAC-&gt;LOS 8        11704 3746         3.120     </span></span>
<span><span class="co">##  ZOO-&gt;RES 3        4062  3746         1.080     </span></span>
<span><span class="co">##  ZOO-&gt;DET 2        3803  3746         1.020     </span></span>
<span><span class="co">##  ZOO-&gt;FBF 2        3741  3746         0.999     </span></span>
<span><span class="co">##  ZOO-&gt;BIV 2        3680  3746         0.982     </span></span>
<span><span class="co">##  ZOO-&gt;ZOO 2        3930  3746         1.050     </span></span>
<span><span class="co">##  ZOO-&gt;LOS 2        3803  3746         1.020     </span></span>
<span><span class="co">##  BIV-&gt;RES 2        3803  3746         1.020     </span></span>
<span><span class="co">##  BIV-&gt;DET 2        3620  3746         0.966     </span></span>
<span><span class="co">##  BIV-&gt;FBF 2        3741  3746         0.999     </span></span>
<span><span class="co">##  BIV-&gt;LOS 2        3741  3746         0.999     </span></span>
<span><span class="co">##  FBF-&gt;RES 2        3803  3746         1.020     </span></span>
<span><span class="co">##  FBF-&gt;DET 2        3741  3746         0.999     </span></span>
<span><span class="co">##  FBF-&gt;FBF 2        3680  3746         0.982     </span></span>
<span><span class="co">##  FBF-&gt;LOS 2        3620  3746         0.966</span></span></code></pre>
<p>Note that the value of the flow “FIX-&gt;PHY” is here greater than 5,
indicating a strong auto-correlation.</p>
<p>The maximum burn-in value and estimate sample size are to be used to
improve the sampling.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get the maximum value of 'Burn-in' (Burn-in is the first column)</span></span>
<span><span class="va">max_burn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">RL</span><span class="op">$</span><span class="va">resmatrix</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co"># Get the maximum value of 'Thinning' (Burn-in is the fifth column)</span></span>
<span><span class="va">max_thin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">RL</span><span class="op">$</span><span class="va">resmatrix</span><span class="op">[</span>,<span class="fl">5</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co"># Get the maximum value of 'Total (N)' (Total (N) is the second column)</span></span>
<span><span class="va">max_total</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">RL</span><span class="op">$</span><span class="va">resmatrix</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Sampling again with those new parameters</span></span>
<span><span class="va">better_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rlim.html">rlim</a></span><span class="op">(</span><span class="va">model</span>, nsamp <span class="op">=</span> <span class="va">max_total</span>, thin <span class="op">=</span> <span class="va">max_thin</span>, burn <span class="op">=</span> <span class="va">max_burn</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="the-geweke-diagnostic">The Geweke diagnostic<a class="anchor" aria-label="anchor" href="#the-geweke-diagnostic"></a>
</h3>
<p>The Geweke diagnostic is a classical statistical test of comparison
of means applied to prescribed proportions of the first and last points
generated by an MCMC algorithm, say <span class="math inline">\(0 &lt;
p_1 &lt; 1\)</span> and <span class="math inline">\(0 &lt; p_2 &lt;
1\)</span>, with <span class="math inline">\(p_1 + p_2 &lt; 1\)</span>.
If the difference of means is too large, the null hypothesis of
convergence is rejected. The values <span class="math inline">\(p_1 =
0.1\)</span> and <span class="math inline">\(p_2 = 0.5\)</span> are
usual.</p>
<p>For each variable, a value <span class="math inline">\(Z\)</span> is
computed, the hypothesis of convergence of the algorithm is rejected if
<span class="math inline">\(\left| Z \right|\)</span> exceeds a
prescribed quantile of the normal distribution. With <span class="math inline">\(p_1 = 0.1\)</span> and <span class="math inline">\(p_2 = 0.5\)</span>, convergence is rejected when
<span class="math inline">\(\left| Z \right| \geq 1.28\)</span>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">frac1</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span><span class="va">frac2</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">G</span> <span class="op">&lt;-</span> <span class="fu">coda</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/coda/man/geweke.diag.html" class="external-link">geweke.diag</a></span><span class="op">(</span><span class="va">sample</span>, frac1 <span class="op">=</span> <span class="va">frac1</span>, frac2 <span class="op">=</span> <span class="va">frac2</span><span class="op">)</span></span>
<span><span class="va">G</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Fraction in 1st window = 0.1</span></span>
<span><span class="co">## Fraction in 2nd window = 0.5 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  FIX-&gt;PHY  IMP-&gt;FBF  DET-&gt;BIV  DET-&gt;ZOO  DET-&gt;BAC  PHY-&gt;RES  PHY-&gt;DET  PHY-&gt;BIV </span></span>
<span><span class="co">##  0.399384 -1.219764 -0.224899  1.165463  0.288149  0.503854  0.342449 -0.117567 </span></span>
<span><span class="co">##  PHY-&gt;ZOO  PHY-&gt;BAC  PHY-&gt;LOS  BAC-&gt;RES  BAC-&gt;DET  BAC-&gt;LOS  ZOO-&gt;RES  ZOO-&gt;DET </span></span>
<span><span class="co">##  1.509264  0.029311 -0.941075  0.890025 -0.110944 -0.048667  2.542936  0.137219 </span></span>
<span><span class="co">##  ZOO-&gt;FBF  ZOO-&gt;BIV  ZOO-&gt;ZOO  ZOO-&gt;LOS  BIV-&gt;RES  BIV-&gt;DET  BIV-&gt;FBF  BIV-&gt;LOS </span></span>
<span><span class="co">## -0.504739 -0.903382  1.516963  2.627267 -0.316630  0.006371 -0.842774 -0.162492 </span></span>
<span><span class="co">##  FBF-&gt;RES  FBF-&gt;DET  FBF-&gt;FBF  FBF-&gt;LOS </span></span>
<span><span class="co">## -0.617774 -0.520566 -1.205047  0.741212</span></span></code></pre>
<p>Note that some values above are greater than 1.28.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># View flows with |Z| greater than 1.28</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">G</span><span class="op">$</span><span class="va">z</span><span class="op">)</span><span class="op">&gt;=</span><span class="fl">1.28</span></span></code></pre></div>
<pre><code><span><span class="co">## FIX-&gt;PHY IMP-&gt;FBF DET-&gt;BIV DET-&gt;ZOO DET-&gt;BAC PHY-&gt;RES PHY-&gt;DET PHY-&gt;BIV </span></span>
<span><span class="co">##    FALSE    FALSE    FALSE    FALSE    FALSE    FALSE    FALSE    FALSE </span></span>
<span><span class="co">## PHY-&gt;ZOO PHY-&gt;BAC PHY-&gt;LOS BAC-&gt;RES BAC-&gt;DET BAC-&gt;LOS ZOO-&gt;RES ZOO-&gt;DET </span></span>
<span><span class="co">##     TRUE    FALSE    FALSE    FALSE    FALSE    FALSE     TRUE    FALSE </span></span>
<span><span class="co">## ZOO-&gt;FBF ZOO-&gt;BIV ZOO-&gt;ZOO ZOO-&gt;LOS BIV-&gt;RES BIV-&gt;DET BIV-&gt;FBF BIV-&gt;LOS </span></span>
<span><span class="co">##    FALSE    FALSE     TRUE     TRUE    FALSE    FALSE    FALSE    FALSE </span></span>
<span><span class="co">## FBF-&gt;RES FBF-&gt;DET FBF-&gt;FBF FBF-&gt;LOS </span></span>
<span><span class="co">##    FALSE    FALSE    FALSE    FALSE</span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Count the number of flows with |Z| greater than 1.28</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">G</span><span class="op">$</span><span class="va">z</span><span class="op">)</span><span class="op">&gt;=</span><span class="fl">1.28</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 4</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="effective-sample-size">Effective Sample Size<a class="anchor" aria-label="anchor" href="#effective-sample-size"></a>
</h3>
<p>The Effective Sample Size (ESS) reflects the amount of
autocorrelation in the MCMC draws. The closer ESS is to N (the sample
size), the better, since it means that the draws are lowly
auto-correlated.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">coda</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/coda/man/effectiveSize.html" class="external-link">effectiveSize</a></span><span class="op">(</span><span class="va">sample</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   FIX-&gt;PHY   IMP-&gt;FBF   DET-&gt;BIV   DET-&gt;ZOO   DET-&gt;BAC   PHY-&gt;RES   PHY-&gt;DET </span></span>
<span><span class="co">##   73.27793 5515.48765 2362.69136 4536.24414   85.57546   82.47209   78.97687 </span></span>
<span><span class="co">##   PHY-&gt;BIV   PHY-&gt;ZOO   PHY-&gt;BAC   PHY-&gt;LOS   BAC-&gt;RES   BAC-&gt;DET   BAC-&gt;LOS </span></span>
<span><span class="co">## 2204.15435 2286.65596 3086.86185 3405.32690  162.45359  114.84217  175.07854 </span></span>
<span><span class="co">##   ZOO-&gt;RES   ZOO-&gt;DET   ZOO-&gt;FBF   ZOO-&gt;BIV   ZOO-&gt;ZOO   ZOO-&gt;LOS   BIV-&gt;RES </span></span>
<span><span class="co">## 3343.66086 2842.34399 5658.98126 4664.53519 4074.24166 3095.57399 2115.14182 </span></span>
<span><span class="co">##   BIV-&gt;DET   BIV-&gt;FBF   BIV-&gt;LOS   FBF-&gt;RES   FBF-&gt;DET   FBF-&gt;FBF   FBF-&gt;LOS </span></span>
<span><span class="co">## 3569.76304 5220.94010 3428.60113 5895.09778 4819.34706 5782.26870 5000.00000</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="adjusting-sampling-methods-and-parameters">Adjusting sampling methods and parameters<a class="anchor" aria-label="anchor" href="#adjusting-sampling-methods-and-parameters"></a>
</h2>
<p>Users can choose the sampling method, the size of the sample and the
values of parameters such as the jump length.</p>
<div class="section level3">
<h3 id="choosing-the-sample-size-and-sampling-method">Choosing the sample size and sampling method<a class="anchor" aria-label="anchor" href="#choosing-the-sample-size-and-sampling-method"></a>
</h3>
<p>By default, <code><a href="../reference/rlim.html">rlim()</a></code> samples 3000 points using the Mirror
Walk algorithm.</p>
<p>The sample size can be chosen as follows.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set the number of points to sample to 10000 using nsamp</span></span>
<span><span class="va">big_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rlim.html">rlim</a></span><span class="op">(</span><span class="va">model</span>, nsamp <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">big_sample</span><span class="op">)</span></span></code></pre></div>
<p>The algorithm can be changed using the “type” argument. “BiW” for the
Billiard Walk, nothing or “MiW” for the Mirror Walk.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use the Billiard Walk algorithm by specifying "BiW" for the type</span></span>
<span><span class="va">billiard_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rlim.html">rlim</a></span><span class="op">(</span><span class="va">model</span>, type <span class="op">=</span> <span class="st">"BiW"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use the Mirror Walk algorithm by specifying "MiW" for the type</span></span>
<span><span class="va">mirror_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rlim.html">rlim</a></span><span class="op">(</span><span class="va">model</span>, type <span class="op">=</span> <span class="st">"MiW"</span><span class="op">)</span></span>
<span><span class="co"># Mirror Walk is also used when type has no value</span></span>
<span><span class="va">mirror_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rlim.html">rlim</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="adjusting-the-value-of-the-jump">Adjusting the value of the jump<a class="anchor" aria-label="anchor" href="#adjusting-the-value-of-the-jump"></a>
</h3>
<p>The choice of the jump is of real importance even if finding an
optimal value is a difficult task. By default, <a href="https://github.com/pregnault/samplelim.git" class="external-link">samplelim</a>
uses an “adaptative jump” defined as one tenth of each range of the <a href="#reduced_polytope">reduced polytope</a>.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Sampling with default jump (adaptative jump)</span></span>
<span><span class="va">default_jump_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rlim.html">rlim</a></span><span class="op">(</span><span class="va">model</span>, nsamp <span class="op">=</span> <span class="fl">1000</span>, type<span class="op">=</span><span class="st">"MiW"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get the value of the adaptative jump</span></span>
<span><span class="co"># Reduce the polytope</span></span>
<span><span class="va">model_reduced</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lim.redpol.html">lim.redpol</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="co"># Obtain the ranges of the reduced polytope and divide them by 10</span></span>
<span><span class="va">ada_jump</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pol.ranges.html">pol.ranges</a></span><span class="op">(</span>G<span class="op">=</span><span class="va">model_reduced</span><span class="op">$</span><span class="va">G</span>,H<span class="op">=</span><span class="va">model_reduced</span><span class="op">$</span><span class="va">H</span><span class="op">)</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">/</span><span class="fl">10</span></span>
<span><span class="va">ada_jump</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] 85.8737072 43.2505575 46.6294874 42.3545594 30.6718427 49.6929519</span></span>
<span><span class="co">##  [7] 43.7658944 49.2052850 13.8997051 21.0003275 29.6836945 14.1018252</span></span>
<span><span class="co">## [13]  1.6407380 17.4951944 29.0894373 19.6763145 38.9700638 19.0621935</span></span>
<span><span class="co">## [19] 26.0386246 40.6307499  0.5742204 23.8641501</span></span></code></pre>
<p>Custom jump may be used, any positive value <span class="math inline">\(\sigma²\)</span> for the BiW, and any vector value
<span class="math inline">\(\sigma^2=(\sigma_1 ²,...,\sigma_n²)\)</span>
for the MiW. Note that the length <span class="math inline">\(n\)</span>
of the vector is the dimension of the reduced polytope. Usually the
default choice is quite good, custom jumps are to be avoided without
valid arguments.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Billiard Walk</span></span>
<span><span class="co"># Set sigma^2 value</span></span>
<span><span class="va">sigma2</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="co"># Sample with chosen jump value</span></span>
<span><span class="va">sample_biw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rlim.html">rlim</a></span><span class="op">(</span><span class="va">model</span>, nsamp <span class="op">=</span> <span class="fl">1000</span>, type <span class="op">=</span> <span class="st">"BiW"</span>, jmp<span class="op">=</span><span class="va">sigma2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Mirror Walk</span></span>
<span><span class="co"># Get the dimension of the reduced polytope</span></span>
<span><span class="va">n</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="fu"><a href="../reference/lim.redpol.html">lim.redpol</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">$</span><span class="va">G</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">n</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 22</span></span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a vector of length n with sigma_i^2 = 4</span></span>
<span><span class="va">sigma2_vec</span><span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">4</span>,<span class="va">n</span><span class="op">)</span></span>
<span><span class="co"># Sample with chosen jump vector</span></span>
<span><span class="va">sample_miw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rlim.html">rlim</a></span><span class="op">(</span><span class="va">model</span>, nsamp <span class="op">=</span> <span class="fl">1000</span>, type <span class="op">=</span> <span class="st">"MiW"</span>, jmp<span class="op">=</span><span class="va">sigma2_vec</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="create-reproducible-examples">Create reproducible examples<a class="anchor" aria-label="anchor" href="#create-reproducible-examples"></a>
</h2>
<p>In certain situations, one may need to provide reproducible examples,
for instance in scientific publications. Reproducibility ensures that
the results remain consistent when the code is rerun, which is
particularly important when randomness is involved.</p>
<p>To ensure a reproducible example a parameter called “seed”, that can
be any integer, is needed with the <code><a href="../reference/rlim.html">rlim()</a></code> function. As far
as the other parameters are unchanged a same seed will produce the same
sample.</p>
<p>The following example generate three samples (two using the same seed
and one with a different) using <code><a href="../reference/rlim.html">rlim()</a></code>. The samples are
then compared in order to check the consistency of the seed.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set the seeds</span></span>
<span><span class="va">seed1</span> <span class="op">&lt;-</span> <span class="fl">123</span></span>
<span><span class="va">seed2</span> <span class="op">&lt;-</span> <span class="fl">456</span> </span>
<span></span>
<span><span class="co"># Generate the samples</span></span>
<span><span class="va">sample1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rlim.html">rlim</a></span><span class="op">(</span><span class="va">model</span>, nsamp <span class="op">=</span> <span class="fl">500</span>, seed <span class="op">=</span> <span class="va">seed1</span><span class="op">)</span></span>
<span><span class="va">sample2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rlim.html">rlim</a></span><span class="op">(</span><span class="va">model</span>, nsamp <span class="op">=</span> <span class="fl">500</span>, seed <span class="op">=</span> <span class="va">seed1</span><span class="op">)</span></span>
<span><span class="va">sample3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rlim.html">rlim</a></span><span class="op">(</span><span class="va">model</span>, nsamp <span class="op">=</span> <span class="fl">500</span>, seed <span class="op">=</span> <span class="va">seed2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare the samples by checking if all the values are the same</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Are sample1 and sample2 the same ? "</span>, <span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="va">sample1</span> <span class="op">==</span> <span class="va">sample2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Are sample1 and sample2 the same ?  TRUE"</span></span></code></pre>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Are sample1 and sample3 the same ? "</span>, <span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="va">sample1</span> <span class="op">==</span> <span class="va">sample3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Are sample1 and sample3 the same ?  FALSE"</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="reduced_polytope">Working with a reduced polytope<a class="anchor" aria-label="anchor" href="#reduced_polytope"></a>
</h2>
<p>The sampling process uses a reduced polytope. The polytope <span class="math inline">\(\mathcal{P} = \{ x \in \mathbb{R}^n: Ax = B, Gx
\geq H \}\)</span> is reduced to a polytope <span class="math inline">\(\mathcal{P'} = \{ x \in \mathbb{R}^{n-k}:
G'x \geq H' \}\)</span> with full rank <span class="math inline">\(n-k\)</span>, with <span class="math inline">\(k\)</span> the rank of the matrix <span class="math inline">\(A\)</span>, <span class="math inline">\(G' =
GZ\)</span>, <span class="math inline">\(H' = H-Gx_0\)</span>, where
the matrix <span class="math inline">\(Z\)</span> is the basis of the
right null space of <span class="math inline">\(A\)</span>. Further,
<span class="math inline">\(x_0\)</span> is a particular solution in
<span class="math inline">\(\mathcal{P}\)</span>.</p>
<blockquote>
<p><strong>Note:</strong> The following section is more theoretical and
advanced. Studying the reduced polytope may be of interest to advanced
readers but may be ignored by practitioners. For more information, see
<a href="http://cran.nexr.com/web/packages/walkr/vignettes/walkr.pdf" class="external-link">Yao
and Kane.</a></p>
</blockquote>
<p>The components of the reduced polytope are obtained from the full
polytope by using <code><a href="../reference/lim.redpol.html">lim.redpol()</a></code>.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get the full polytope</span></span>
<span><span class="va">DF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"DeclarationFileBOWF-short.txt"</span>, package <span class="op">=</span> <span class="st">"samplelim"</span><span class="op">)</span></span>
<span><span class="va">full</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/df2lim.html">df2lim</a></span><span class="op">(</span><span class="va">DF</span><span class="op">)</span></span>
<span><span class="co"># Project the polytope</span></span>
<span><span class="va">reduced</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lim.redpol.html">lim.redpol</a></span><span class="op">(</span><span class="va">full</span><span class="op">)</span></span>
<span><span class="co"># Comparison of the shape of the constraint matrices of the two polytopes</span></span>
<span><span class="co"># full</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">full</span><span class="op">$</span><span class="va">G</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 72 28</span></span></code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># projected</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">reduced</span><span class="op">$</span><span class="va">G</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 72 22</span></span></code></pre>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get k the rank of the matrix A</span></span>
<span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/qr.html" class="external-link">qr</a></span><span class="op">(</span><span class="va">full</span><span class="op">$</span><span class="va">A</span><span class="op">)</span><span class="op">$</span><span class="va">rank</span></span>
<span><span class="co"># Get the Z matrix</span></span>
<span><span class="va">reduced</span><span class="op">$</span><span class="va">Z</span></span>
<span><span class="co"># Get the particular solution x0</span></span>
<span><span class="va">reduced</span><span class="op">$</span><span class="va">x0</span></span>
<span><span class="co"># Get the matrix G'</span></span>
<span><span class="va">reduced</span><span class="op">$</span><span class="va">G</span></span>
<span><span class="co"># Get the vector H'</span></span>
<span><span class="va">reduced</span><span class="op">$</span><span class="va">H</span></span></code></pre></div>
<p>The reduced polytope can now be sampled. The obtained sample leads to
a sample of the full polytope by using <code><a href="../reference/lim.redpol.html">red2full()</a></code> in which
the particular solution <span class="math inline">\(x_0\)</span> and the
matrix <span class="math inline">\(Z\)</span> have to be given.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Sampling the reduced polytope</span></span>
<span><span class="va">sample_reduced</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rlim.html">rlim</a></span><span class="op">(</span><span class="va">reduced</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sample_reduced</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           [,1]     [,2]      [,3]     [,4]      [,5]     [,6]     [,7]</span></span>
<span><span class="co">## [1,]  74.83223 43.13515  41.59024 28.49893 10.329634 34.89799 18.39237</span></span>
<span><span class="co">## [2,]  84.78960 58.64567  60.09307 27.65637 16.962835 31.76416 15.99816</span></span>
<span><span class="co">## [3,]  59.04672 67.51550  22.28097 38.07940  1.629436 26.12109 37.11897</span></span>
<span><span class="co">## [4,] 100.85553 57.84883 104.06348 45.11101 27.580583 60.73539 68.45584</span></span>
<span><span class="co">## [5,]  95.62668 77.17322  69.96362 46.41447 27.955809 60.22458 54.22486</span></span>
<span><span class="co">## [6,] 119.67894 48.76823  46.95739 56.01541 47.899503 79.03990 40.05395</span></span>
<span><span class="co">##           [,8]       [,9]    [,10]     [,11]      [,12]    [,13]     [,14]</span></span>
<span><span class="co">## [1,]  7.837591  -3.690632 35.36470 -37.49394 12.0562498 1.577896 -3.535907</span></span>
<span><span class="co">## [2,] 18.430146  14.481379 30.82407 -40.69700 25.2339152 2.390334 15.437025</span></span>
<span><span class="co">## [3,] -9.347489 -14.486050 27.97505 -36.57888 -2.2503842 1.796701 -7.303899</span></span>
<span><span class="co">## [4,] 14.279603   5.107705 57.17872 -14.96610  0.4293629 6.355259  4.524261</span></span>
<span><span class="co">## [5,]  7.279720   6.791954 46.19881 -21.78204 16.6952150 3.189978  1.930370</span></span>
<span><span class="co">## [6,]  1.190374  -6.695064 32.42994 -41.25052 10.0768679 1.722250 -5.028717</span></span>
<span><span class="co">##           [,15]    [,16]     [,17]      [,18]    [,19]    [,20]    [,21]</span></span>
<span><span class="co">## [1,] -14.782424 15.87965 -47.70550 -16.498226 39.92648 62.57160 1.524565</span></span>
<span><span class="co">## [2,]   0.194600 10.89087 -59.63070 -15.769408 48.93137 61.62917 1.430687</span></span>
<span><span class="co">## [3,]   4.163762 21.04047 -43.21725 -21.422267 35.55963 73.11584 3.242878</span></span>
<span><span class="co">## [4,]  -9.836142 36.51153 -16.04820  -8.912600 26.32741 49.94306 3.337437</span></span>
<span><span class="co">## [5,]   1.590903 42.40694 -31.98019   1.117422 29.55629 54.53992 2.262555</span></span>
<span><span class="co">## [6,] -18.387164 10.00307 -53.69917 -19.320047 42.59050 69.24565 3.240836</span></span>
<span><span class="co">##         [,22]</span></span>
<span><span class="co">## [1,] 34.60742</span></span>
<span><span class="co">## [2,] 43.99625</span></span>
<span><span class="co">## [3,] 31.55693</span></span>
<span><span class="co">## [4,] 17.49126</span></span>
<span><span class="co">## [5,] 27.42026</span></span>
<span><span class="co">## [6,] 38.59601</span></span></code></pre>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Turn sampled points of the reduced polytope into sampled points of the full polytope</span></span>
<span><span class="va">sample_full</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lim.redpol.html">red2full</a></span><span class="op">(</span><span class="va">sample_reduced</span>, <span class="va">reduced</span><span class="op">$</span><span class="va">x0</span>, <span class="va">reduced</span><span class="op">$</span><span class="va">Z</span><span class="op">)</span></span></code></pre></div>
<p>Conversely, note that a sample of the full polytope can also be
turned into a sample of the reduced polytope with
<code><a href="../reference/lim.redpol.html">full2red()</a></code>.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sample_reduced2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lim.redpol.html">full2red</a></span><span class="op">(</span><span class="va">sample_full</span>, <span class="va">reduced</span><span class="op">$</span><span class="va">x0</span>, <span class="va">reduced</span><span class="op">$</span><span class="va">Z</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="performance-comparison-between-limsolve-and-samplelim">Performance comparison between limSolve and samplelim<a class="anchor" aria-label="anchor" href="#performance-comparison-between-limsolve-and-samplelim"></a>
</h2>
<p>This section compare the execution time of the
<code><a href="https://rdrr.io/pkg/limSolve/man/xsample.html" class="external-link">xsample()</a></code>function from <code>{limSolve}</code> and the
<code><a href="../reference/rlim.html">rlim()</a></code> function from <a href="https://github.com/pregnault/samplelim.git" class="external-link">samplelim</a>. Both
functions use here the same MiW algorithm and the same sample size (1000
points).</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"limSolve"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Execution time for xsample (limSolve)</span></span>
<span><span class="va">start_time1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">sample1</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/limSolve/man/xsample.html" class="external-link">xsample</a></span><span class="op">(</span>E <span class="op">=</span> <span class="va">model</span><span class="op">$</span><span class="va">A</span>, F <span class="op">=</span> <span class="va">model</span><span class="op">$</span><span class="va">B</span>, G <span class="op">=</span> <span class="va">model</span><span class="op">$</span><span class="va">G</span>, H <span class="op">=</span> <span class="va">model</span><span class="op">$</span><span class="va">H</span>, iter <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">end_time1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">time1</span> <span class="op">&lt;-</span> <span class="va">end_time1</span> <span class="op">-</span> <span class="va">start_time1</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Time for xsample():"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">time1</span>,<span class="fl">3</span><span class="op">)</span>, <span class="st">"seconds"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Time for xsample(): 1.981 seconds"</span></span></code></pre>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Execution time for rlim (samplelim)</span></span>
<span><span class="va">start_time2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">sample2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rlim.html">rlim</a></span><span class="op">(</span><span class="va">model</span>, nsamp <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">end_time2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">time2</span> <span class="op">&lt;-</span> <span class="va">end_time2</span> <span class="op">-</span> <span class="va">start_time2</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Time for rlim():"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">time2</span>,<span class="fl">3</span><span class="op">)</span>, <span class="st">"seconds"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Time for rlim(): 0.284 seconds"</span></span></code></pre>
<p>Even with a small sample size, <code><a href="../reference/rlim.html">rlim()</a></code> outperforms
<code><a href="https://rdrr.io/pkg/limSolve/man/xsample.html" class="external-link">xsample()</a></code>. This performance advantage increases with the
sample size.</p>
</div>
<div class="section level2">
<h2 id="plot-distributions-of-sample-variables">Plot distributions of sample variables<a class="anchor" aria-label="anchor" href="#plot-distributions-of-sample-variables"></a>
</h2>
<p>Distribution of sample variables as well as scatter plots for pairs
of variables can be shown using the <code><a href="https://ggobi.github.io/ggally/reference/ggpairs.html" class="external-link">ggpairs()</a></code> function. For
a better visibility, it is recommended not to take more than 5 variables
at the same time. The indexes of the desired variables must be selected
manually. In this example we consider the variables involving the BAC
compartment.</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ggpairs() needs the GGally package </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ggobi.github.io/ggally/" class="external-link">"GGally"</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The sample needs to be converted as a data.frame</span></span>
<span><span class="va">sampleDF</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">sample</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View all the variables names and their indexes</span></span>
<span><span class="va">vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">sampleDF</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">vars</span><span class="op">)</span>, <span class="va">vars</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      [,1]       [,2]       [,3]       [,4]       [,5]       [,6]      </span></span>
<span><span class="co">##      "1"        "2"        "3"        "4"        "5"        "6"       </span></span>
<span><span class="co">## vars "FIX-&gt;PHY" "IMP-&gt;FBF" "DET-&gt;BIV" "DET-&gt;ZOO" "DET-&gt;BAC" "PHY-&gt;RES"</span></span>
<span><span class="co">##      [,7]       [,8]       [,9]       [,10]      [,11]      [,12]     </span></span>
<span><span class="co">##      "7"        "8"        "9"        "10"       "11"       "12"      </span></span>
<span><span class="co">## vars "PHY-&gt;DET" "PHY-&gt;BIV" "PHY-&gt;ZOO" "PHY-&gt;BAC" "PHY-&gt;LOS" "BAC-&gt;RES"</span></span>
<span><span class="co">##      [,13]      [,14]      [,15]      [,16]      [,17]      [,18]     </span></span>
<span><span class="co">##      "13"       "14"       "15"       "16"       "17"       "18"      </span></span>
<span><span class="co">## vars "BAC-&gt;DET" "BAC-&gt;LOS" "ZOO-&gt;RES" "ZOO-&gt;DET" "ZOO-&gt;FBF" "ZOO-&gt;BIV"</span></span>
<span><span class="co">##      [,19]      [,20]      [,21]      [,22]      [,23]      [,24]     </span></span>
<span><span class="co">##      "19"       "20"       "21"       "22"       "23"       "24"      </span></span>
<span><span class="co">## vars "ZOO-&gt;ZOO" "ZOO-&gt;LOS" "BIV-&gt;RES" "BIV-&gt;DET" "BIV-&gt;FBF" "BIV-&gt;LOS"</span></span>
<span><span class="co">##      [,25]      [,26]      [,27]      [,28]     </span></span>
<span><span class="co">##      "25"       "26"       "27"       "28"      </span></span>
<span><span class="co">## vars "FBF-&gt;RES" "FBF-&gt;DET" "FBF-&gt;FBF" "FBF-&gt;LOS"</span></span></code></pre>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Choose the index of desired variables </span></span>
<span><span class="va">keep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">10</span>,<span class="fl">12</span>,<span class="fl">13</span>,<span class="fl">14</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the pairs plot</span></span>
<span><span class="fu"><a href="https://ggobi.github.io/ggally/reference/ggpairs.html" class="external-link">ggpairs</a></span><span class="op">(</span><span class="va">sampleDF</span>,columns<span class="op">=</span><span class="va">keep</span>, lower<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>continuous<span class="op">=</span><span class="fu"><a href="https://ggobi.github.io/ggally/reference/wrap.html" class="external-link">wrap</a></span><span class="op">(</span><span class="st">"points"</span>,alpha<span class="op">=</span><span class="fl">0.3</span>,size<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span>,</span>
<span>combo<span class="op">=</span><span class="fu"><a href="https://ggobi.github.io/ggally/reference/wrap.html" class="external-link">wrap</a></span><span class="op">(</span><span class="st">"dot"</span>,alpha<span class="op">=</span><span class="fl">0.4</span>,size<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span><span class="op">)</span>,title <span class="op">=</span><span class="st">"PairPlot"</span><span class="op">)</span></span></code></pre></div>
<p><img src="high_dimensional_polytope_sampling_with_samplelim_files/figure-html/pair_plot-1.png" width="700">
For each plot, the name of the first variable is at the top and the name
of the second on the right. Graphs on the diagonal are distribution
plots. The graphs at bottom left are scatter plots, and the values at
top right are Pearson correlation coefficients between the two
associated variables.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jacques Bréhélin, Matthieu Dien, Théo Grente, Philippe Regnault.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
