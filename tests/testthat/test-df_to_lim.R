# Tests on the behaviour of df_to_lim ----

test_that("df2lim returns expected lim object for a well formated existing declaration file",{
  
  #Get path to an example file
  DF <- system.file("extdata", "DeclarationFileBOWF-short.txt", package = "samplelim")
  
  # Check if the file path is valid
  expect_true(file.exists(DF))
  
  #Import the matching file 
  model <- df2lim(DF)
  
  # Check that the object is of the correct class
  expect_s3_class(model, "lim")
  
  #Expected object attributes obtained using the dput() function
  expected_file <- DF
  expected_NUnknowns <- 28
  expected_NEquations <- 0
  expected_NConstraints <- 44L
  expected_NComponents <- 6L
  expected_NExternal <- 4L
  expected_NVariables <- 13L
  expected_A <- structure(c(0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 
                            -1, 0, 0, 1, 0, 0, -1, 0, 0, 0, 1, 0, -1, 0, 0, 0, 0, -1, 0, 
                            0, 0, 0, 0, -1, 1, 0, 1, 0, 0, -1, 0, 0, 0, 1, 0, -1, 0, 0, 0, 
                            0, 1, -1, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, -1, 
                            0, 1, 0, 0, 0, -1, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, -1, 0, 0, 1, 
                            1, 0, -1, 0, 0, 0, 0, 1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            -1, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, -1, 0, 0, 0, 1, 1, -1, 0, 
                            0, 0, 0, 0, -1, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 
                            1, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0), dim = c(6L, 28L))
  expected_B <- c(0, 0, 0, 0, 0, 0)
  expected_G <- structure(c(-1, 1, 0.3, -0.05, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0.5, -0.05, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0.5, -0.1, 0, 0, 0, 0, 0, 0, 0, 0, -0.73, 0.91, 
                            0, 0, 0, 0, 0, 0, -1, 1, 0, 0, -0.7, 0.36, 0.3, 0.3, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0.42, -0.18, 0, 0, 0, 0, 0, 0, 0, 0, -0.7, 0.95, 0, 
                            0, 0, 0, 0, 0, -1, 1, 0, 0, 0, 0, 0.2, 0.75, -0.55, -0.65, 0.85, 
                            0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.3, -0.1, 0, 
                            0, 0, 0, 0, 0, 0.5, -0.1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -0.5, 
                            0.75, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.1, -0.83, -0.83, 
                            0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0.35, -0.05, 0, 0, 0, 0, -0.4, 0.89, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.3, 0.3, 0, 0, 0, 
                            0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 1, -1, -1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, -1, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, -1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.42, -0.18, 0, 0, 
                            0, 0, 0, 0, 0, 0, -0.7, 0.95, 0, 0, 0, 0, 0, 0, -1, 1, 0, 0, 
                            0, 0, 0.2, -0.25, 0.45, 0.35, -0.15, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0.3, -0.1, 0, 0, 0, 0, 0, 0, 0.5, -0.1, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -0.5, 0.75, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0.1, 0.17, 0.17, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.35, -0.05, 
                            0, 0, 0, 0, -0.4, 0.89, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, -0.7, -0.7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 1, 0, 0, 0, 0, 1, -1, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 1, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, -1, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 1, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0.5, -0.1, 0, 0, 0, 0, 0, 0, 0, 0, -0.73, 0.91, 0, 0, 0, 0, 0, 
                            0, -1, 1, 0, 0, 0.3, 0.36, 0.3, -0.7, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.42, 
                            -0.18, 0, 0, 0, 0, 0, 0, 0, 0, -0.7, 0.95, 0, 0, 0, 0, 0, 0, 
                            -1, 1, 0, 0, 0, 0, -0.8, 0.75, -0.55, 0.35, -0.15, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.3, -0.1, 0, 0, 0, 0, 0, 
                            0, 0.5, -0.1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -0.5, 0.75, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -0.9, -0.83, 0.17, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, -1, 0, 0, 0, 0, 
                            0, 0, 1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 1, 0, 0, 0, 
                            0, 0, 0, 0, 0, 1, -1, 0, 0, 0, 0, 0, 0, 1, -1, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0.5, -0.1, 0, 0, 0, 0, 0, 0, 0, 0, -0.73, 0.91, 0, 0, 
                            0, 0, 0, 0, -1, 1, 0, 0, 0.3, 0.36, -0.7, 0.3, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, -1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, -1, 
                            0, 0, 0, 0, 0, 0, 1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 
                            1, 0, 0, 0, 0, 0, 0, 0, 0, 1, -1, 0, 0, 0, 0, 0, 0, 1, -1, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0.5, -0.1, 0, 0, 0, 0, 0, 0, 0, 0, 
                            -0.73, 0.91, 0, 0, 0, 0, 0, 0, -1, 1, 0, 0, 0.3, -0.64, 0.3, 
                            0.3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                            0, 0, 0, 0, 0, 0, 1), dim = c(72L, 28L))
  expected_H <- c(-172, 103, 0, 0, 0, 0, -31.901131, 3.1901131, 0, 0, 0, 0, 0, 
                  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -6.3802262, 1.722661074, 
                  -97.6875, 19.5375, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                  0, 0, 0, 0, 0, 0, 0)
  expected_Cost <- NULL
  expected_Profit <- NULL
  expected_Flowmatrix <- structure(c(27, 23, 17, 0, 0, 0, 0, 0, 0, 2, 0, 0, 18, 0, 8, 
                                     3, 0, 0, 0, 0, 0, 0, 19, 0, 9, 4, 0, 0, 0, 0, 0, 0, 0, 0, 10, 
                                     5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 26, 22, 16, 13, 
                                     7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 25, 21, 15, 12, 
                                     6, 0, 0, 0, 0, 0, 28, 24, 20, 14, 11, 0, 0, 0, 0, 0, 0, 0, 0, 
                                     0, 0, 0, 0, 0, 0, 0), dim = c(10L, 10L), dimnames = list(c("FBF", 
                                                                                                "BIV", "ZOO", "BAC", "PHY", "DET", "FIX", "RES", "LOS", "IMP"
                                     ), c("FBF", "BIV", "ZOO", "BAC", "PHY", "DET", "FIX", "RES", 
                                          "LOS", "IMP")))
  expected_VarA <- structure(c(0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 1, 0, 0, 0, 
                               1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 
                               1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 
                               0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 1, -1, 0, 0, 
                               0, 0, 0, 0, 0, 0, 0, -1, 0, 0, -1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 
                               0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                               1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                               0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 
                               -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                               0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 
                               -1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 
                               0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 
                               0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                               0, 0, 0, 0, -1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 
                               0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                               0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 1, 0, 
                               0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 
                               0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0), dim = c(13L, 
                                                                                                    28L))
  expected_VarB <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
  expected_Parameters <- structure(list(name = c("FBFBiomass", "BIVBiomass", "ZOOBiomass", 
                                                 "BACBiomass", "PHYBiomass", "DETBiomass", "minNPP", "maxNPP", 
                                                 "minZOOres", "maxZOOres", "minPHYres", "maxPHYres", "minBIVpb", 
                                                 "maxBIVpb", "minFBFpb", "maxFBFpb", "minFBFpq", "maxFBFpq", "minBIVpq", 
                                                 "maxBIVpq", "minBACpq", "maxBACpq", "minPLKpq", "maxPLKpq", "minFISHuq", 
                                                 "maxFISHuq", "minBIVuq", "maxBIVuq", "minZOOuq", "maxZOOuq", 
                                                 "minBACuq", "maxBACuq", "minPHYuq", "maxPHYuq"), val = c(3.1901131, 
                                                                                                          19.5375, 1.72, 0.75, 3.24, 19, 103, 172, 0.1, 0.3, 0.05, 0.3, 
                                                                                                          1, 5, 0.54, 2, 0.09, 0.27, 0.05, 0.3, 0.11, 0.6, 0.25, 0.5, 0.1, 
                                                                                                          0.5, 0.18, 0.42, 0.1, 0.5, 0.05, 0.35, 0.05, 0.5)), class = "data.frame", row.names = c(NA, 
                                                                                                                                                                                                  -34L))
  expected_Components <- structure(list(name = c("FBF", "BIV", "ZOO", "BAC", "PHY", "DET"
  ), val = c(3.1901131, 19.5375, 1.72, 0.75, 3.24, 19)), class = "data.frame", row.names = c(NA, 
                                                                                             -6L))
  expected_Externals <- structure(list(name = c("FIX", "RES", "LOS", "IMP"), val = c(NA_real_, 
                                                                                     NA_real_, NA_real_, NA_real_)), class = "data.frame", row.names = c(NA, 
                                                                                                                                                         -4L))
  expected_rates <- structure(list(name = c("FBF", "BIV", "ZOO", "BAC", "PHY", "DET"
  ), val = c(0, 0, 0, 0, 0, 0)), class = "data.frame", row.names = c(NA, 
                                                                     -6L))
  expected_markers <- NULL
  expected_Variables <- c("FBFIngest", "BIVIngest", "ZOOIngest", "BACIngest", "FBFprod", 
                          "BACprod", "ZOOprod", "BIVprod", "PHYprod", "GPP", "totRES", 
                          "Herbivory", "DETritivory")
  expected_costnames <- NULL
  expected_profitnames <- NULL
  expected_eqnames <- NULL
  expected_ineqnames <- c("ineq1", "ineq2", "ineq3", "ineq4", "ineq5", "ineq6", "ineq7", 
                         "ineq8", "ineq9", "ineq10", "ineq11", "ineq12", "ineq13", "ineq14", 
                         "ineq15", "ineq16", "ineq17", "ineq18", "ineq19", "ineq20", "ineq21", 
                         "ineq22", "ineq23", "ineq24", "ineq25", "ineq26", "ineq27", "ineq28", 
                         "ineq29", "ineq30", "ineq31", "ineq32", "ineq33", "ineq34", "ineq35", 
                         "ineq36", "ineq37", "ineq38", "ineq39", "ineq40", "ineq41", "ineq42", 
                         "ineq43", "ineq44")
  expected_Unknowns <- c("FIX->PHY", "IMP->FBF", "DET->BIV", "DET->ZOO", "DET->BAC", 
                         "PHY->RES", "PHY->DET", "PHY->BIV", "PHY->ZOO", "PHY->BAC", "PHY->LOS", 
                         "BAC->RES", "BAC->DET", "BAC->LOS", "ZOO->RES", "ZOO->DET", "ZOO->FBF", 
                         "ZOO->BIV", "ZOO->ZOO", "ZOO->LOS", "BIV->RES", "BIV->DET", "BIV->FBF", 
                         "BIV->LOS", "FBF->RES", "FBF->DET", "FBF->FBF", "FBF->LOS")
  expected_ispos <-TRUE
    
  #Check that all attributes have the expected values
  expect_equal(model$file,expected_file) 
  expect_equal(model$NUnknowns,expected_NUnknowns) 
  expect_equal(model$NEquations,expected_NEquations) 
  expect_equal(model$NConstraints,expected_NConstraints) 
  expect_equal(model$NComponents,expected_NComponents) 
  expect_equal(model$NExternal,expected_NExternal) 
  expect_equal(model$NVariables,expected_NVariables) 
  expect_equal(model$A,expected_A)
  expect_equal(model$B,expected_B) 
  expect_equal(model$G,expected_G) 
  expect_equal(model$H,expected_H) 
  expect_equal(model$Cost,expected_Cost)
  expect_equal(model$Profit,expected_Profit)
  expect_equal(model$Flowmatrix,expected_Flowmatrix)
  expect_equal(model$VarA,expected_VarA)
  expect_equal(model$VarB,expected_VarB)
  expect_equal(model$Parameters,expected_Parameters)
  expect_equal(model$Components,expected_Components)
  expect_equal(model$Externals,expected_Externals)
  expect_equal(model$rates,expected_rates)
  expect_equal(model$markers,expected_markers)
  expect_equal(model$Variables,expected_Variables)
  expect_equal(model$costnames,expected_costnames)
  expect_equal(model$profitnames,expected_profitnames)
  expect_equal(model$eqnames,expected_eqnames)
  expect_equal(model$ineqnames,expected_ineqnames)
  expect_equal(model$Unknowns,expected_Unknowns)
  expect_equal(model$ispos,expected_ispos)
  
})
